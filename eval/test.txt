def get_toc_text_from_pdf_bytes(pdf_bytes: bytes, page_num: int = 1) -> str:
    """Extracts raw text from a specific page of a PDF file in memory."""
    if not pdf_bytes:
        raise ValueError("PDF bytes are empty.")
    
    try:
        # Open PDF from memory stream
        with fitz.open(stream=pdf_bytes, filetype="pdf") as doc:
            if page_num < len(doc):
                page = doc.load_page(page_num)
                return page.get_text("text")
            else:
                # Fallback to first page if specified page doesn't exist
                print(f"Warning: Page {page_num} not found. Falling back to page 0.")
                page = doc.load_page(0)
                return page.get_text("text")
    except Exception as e:
        raise IOError(f"Error opening or reading PDF bytes: {e}") from e
# --- END NEW FUNCTION ---
